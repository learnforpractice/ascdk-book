
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../notify/">
      
      
        <link rel="next" href="../crypto/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.4">
    
    
      
        <title>Database Operations - AssemblyScript Smart Contracts Development Cook Book</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.240905d7.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#database-operations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../" title="AssemblyScript Smart Contracts Development Cook Book" class="md-header__button md-logo" aria-label="AssemblyScript Smart Contracts Development Cook Book" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AssemblyScript Smart Contracts Development Cook Book
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Database Operations
            
          </span>
        </div>
      </div>
    </div>
    
    
      <div class="md-header__option">
        <div class="md-select">
          
          <button class="md-header__button md-icon" aria-label="Select language">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
          </button>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="../../database/" hreflang="en" class="md-select__link">
                    English
                  </a>
                </li>
              
                <li class="md-select__item">
                  <a href="../../zh/database/" hreflang="zh" class="md-select__link">
                    中文
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/learnforpractice/ascdk-book" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../" title="AssemblyScript Smart Contracts Development Cook Book" class="md-nav__button md-logo" aria-label="AssemblyScript Smart Contracts Development Cook Book" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    AssemblyScript Smart Contracts Development Cook Book
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/learnforpractice/ascdk-book" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../prelude/" class="md-nav__link">
        Prerequisite Knowledge
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../env/" class="md-nav__link">
        Env
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../helloworld/" class="md-nav__link">
        HelloWorld
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../deploy/" class="md-nav__link">
        Deploying a Smart Contract
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ui/" class="md-nav__link">
        Interact with Digital Wallets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../action/" class="md-nav__link">
        Using Inline Action in Smart Contracts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../notify/" class="md-nav__link">
        requireRecipient Function
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Database Operations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Database Operations
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#storefindupdate" class="md-nav__link">
    store/find/update
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remove" class="md-nav__link">
    Remove
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lowerboundupperbound" class="md-nav__link">
    lowerBound/upperBound
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#querying-the-table-using-the-api" class="md-nav__link">
    Querying the table using the API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage-query-and-update-of-secondary-indexes" class="md-nav__link">
    Storage, Query, and Update of Secondary Indexes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deletion-of-secondary-indexes" class="md-nav__link">
    Deletion of Secondary Indexes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-api-for-secondary-index-query-on-tables" class="md-nav__link">
    Using API for Secondary Index Query on Tables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../crypto/" class="md-nav__link">
        Functions Related to Cryptography
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../common/" class="md-nav__link">
        Common Smart Contract Functions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../abi/" class="md-nav__link">
        Detailed Explanation of ABI Types
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../callc.md" class="md-nav__link">
        None
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#storefindupdate" class="md-nav__link">
    store/find/update
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remove" class="md-nav__link">
    Remove
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lowerboundupperbound" class="md-nav__link">
    lowerBound/upperBound
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#querying-the-table-using-the-api" class="md-nav__link">
    Querying the table using the API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage-query-and-update-of-secondary-indexes" class="md-nav__link">
    Storage, Query, and Update of Secondary Indexes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deletion-of-secondary-indexes" class="md-nav__link">
    Deletion of Secondary Indexes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-api-for-secondary-index-query-on-tables" class="md-nav__link">
    Using API for Secondary Index Query on Tables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="database-operations">Database Operations</h1>
<p>On-chain data storage and retrieval is a key feature of smart contracts. The EOS chain has implemented a memory database that supports data storage in the form of tables. Each item in each table has a unique primary key, which is of the uint64 type. The raw data stored in the table is binary data of arbitrary length. When the smart contract calls the function to store data, the data of the class is serialized and stored in the table. When reading, the original data is converted into class objects through deserialization. It also supports secondary index tables of u64, u128, u256, f64, and Float128 types. Secondary index tables can be seen as special tables with fixed data length. Primary index tables and secondary index tables can be used together to achieve multi-index functions. A secondary index table can have multiple, and the values in the secondary index table can be duplicated, but the primary key of the primary index table must be unique.</p>
<p>Below, let's discuss the use of EOS's on-chain memory database using an example.</p>
<h2 id="storefindupdate">store/find/update</h2>
<p>Storage, lookup, and update are the most basic functions of a database. The following code demonstrates how to perform on-chain counting through these three functions.</p>
<p><a href="https://github.com/learnforpractice/ascdk-book/tree/master/examples/counter">Full code</a></p>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Name</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Contract</span><span class="p">,</span>
<span class="w">    </span><span class="nx">print</span><span class="p">,</span>
<span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;asm-chain&quot;</span><span class="p">;</span>

<span class="kd">@table</span><span class="p">(</span><span class="s2">&quot;counter&quot;</span><span class="p">)</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">Counter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="kt">u64</span><span class="p">;</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="nx">count</span><span class="o">:</span><span class="w"> </span><span class="kt">u64</span><span class="p">;</span>
<span class="w">    </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">count</span><span class="o">:</span><span class="w"> </span><span class="kt">u64</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">count</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Name</span><span class="p">.</span><span class="nx">fromString</span><span class="p">(</span><span class="s2">&quot;counter&quot;</span><span class="p">).</span><span class="nx">N</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">@primary</span>
<span class="w">    </span><span class="nx">get</span><span class="w"> </span><span class="nx">primary</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nx">u64</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">key</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">@contract</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">MyContract</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">Contract</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">receiver</span><span class="o">:</span><span class="w"> </span><span class="kt">Name</span><span class="p">,</span><span class="w"> </span><span class="nx">firstReceiver</span><span class="o">:</span><span class="w"> </span><span class="kt">Name</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="o">:</span><span class="w"> </span><span class="kt">Name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">super</span><span class="p">(</span><span class="nx">receiver</span><span class="p">,</span><span class="w"> </span><span class="nx">firstReceiver</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">@action</span><span class="p">(</span><span class="s2">&quot;inc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">inc</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">mi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Counter</span><span class="p">.</span><span class="ow">new</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">receiver</span><span class="p">);</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mi</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">Name</span><span class="p">.</span><span class="nx">fromString</span><span class="p">(</span><span class="s2">&quot;counter&quot;</span><span class="p">).</span><span class="nx">N</span><span class="p">);</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">count</span><span class="o">:</span><span class="w"> </span><span class="kt">u64</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">payer</span><span class="o">:</span><span class="w"> </span><span class="kt">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">receiver</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">it</span><span class="p">.</span><span class="nx">isOk</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mi</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">it</span><span class="p">)</span>
<span class="w">            </span><span class="nx">counter</span><span class="p">.</span><span class="nx">count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">            </span><span class="nx">mi</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">it</span><span class="p">,</span><span class="w"> </span><span class="nx">counter</span><span class="p">,</span><span class="w"> </span><span class="nx">payer</span><span class="p">);</span>
<span class="w">            </span><span class="nx">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">counter</span><span class="p">.</span><span class="nx">count</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Counter</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
<span class="w">            </span><span class="nx">mi</span><span class="p">.</span><span class="nx">store</span><span class="p">(</span><span class="nx">counter</span><span class="p">,</span><span class="w"> </span><span class="nx">payer</span><span class="p">);</span>
<span class="w">            </span><span class="nx">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nx">print</span><span class="p">(</span><span class="sb">`++++++++count:</span><span class="si">${</span><span class="nx">count</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Let's explain the above code:</p>
<ul>
<li><code>@primary</code> specifies a primary index member variable as key, of <code>u64</code> type.</li>
<li><code>@table("counter")</code> This line of code defines a table named <code>counter</code>, which is a <code>name</code> structure. The <code>table</code> decorator guides the compiler to generate table-related code. The generated code encapsulates the <code>MultiIndex</code> structure related code in <code>asm-chain</code>, which makes it easier for developers to call.</li>
<li><code>@action("inc")</code> indicates that the <code>inc</code> method is an <code>action</code> that will be triggered by the Action structure included in the Transaction.</li>
<li><code>let mi = Counter.new(this.receiver);</code> indicates to create a table. <code>this.receiver</code> specifies the current contract's account name, indicating that the table is stored in the current contract account.</li>
<li><code>let it = mi.find(Name.fromString("counter").N);</code> is used to find the value where the primary index is located. The returned value is of the <code>PrimaryIterator</code> type.</li>
<li><code>let counter = mi.get(it)</code> is used to get the value in <code>PrimaryIterator</code>. If the value does not exist, <code>mi.store(counter, payer);</code> is called to save a new value to the database. Otherwise, after increasing the count by 1, <code>mi.update(it, counter, payer);</code> is called to update the data in the database. The payer specifies which account pays for RAM resources, and it is required to be signed with the <code>active</code> permission of this account in the Transaction.</li>
</ul>
<p>Compilation:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>examples/counter
yarn
yarn<span class="w"> </span>build
</code></pre></div>
<p>Testing:</p>
<div class="highlight"><pre><span></span><code>ipyeos<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w"> </span>-s<span class="w"> </span>-x<span class="w"> </span>test.py<span class="w"> </span>-k<span class="w"> </span>test_inc
</code></pre></div>
<p>The test code being run is as follows:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@chain_test</span>
<span class="k">def</span> <span class="nf">test_inc</span><span class="p">(</span><span class="n">tester</span><span class="p">):</span>
    <span class="n">deploy_contract</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span> <span class="s1">&#39;counter&#39;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;account&#39;</span><span class="p">:</span> <span class="s1">&#39;hello&#39;</span><span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">push_action</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;inc&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hello&#39;</span><span class="p">:</span> <span class="s1">&#39;active&#39;</span><span class="p">})</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;++++++elapsed: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;elapsed&#39;</span><span class="p">])</span>
    <span class="n">tester</span><span class="o">.</span><span class="n">produce_block</span><span class="p">()</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">get_table_rows</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;counter&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;+++++++rows: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ret</span><span class="p">)</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">push_action</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;inc&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hello&#39;</span><span class="p">:</span> <span class="s1">&#39;active&#39;</span><span class="p">})</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;++++++elapsed: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;elapsed&#39;</span><span class="p">])</span>
    <span class="n">tester</span><span class="o">.</span><span class="n">produce_block</span><span class="p">()</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">get_table_rows</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;counter&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;+++++++rows: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ret</span><span class="p">)</span>
</code></pre></div>
<h2 id="remove">Remove</h2>
<p>The following code demonstrates how to delete an item of data from the database.</p>
<div class="highlight"><pre><span></span><code><span class="kd">@action</span><span class="p">(</span><span class="s2">&quot;testremove&quot;</span><span class="p">)</span>
<span class="nx">testRemove</span><span class="p">(</span><span class="nx">account</span><span class="o">:</span><span class="w"> </span><span class="kt">Name</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">requireAuth</span><span class="p">(</span><span class="nx">account</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">mi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Counter</span><span class="p">.</span><span class="ow">new</span><span class="p">(</span><span class="nx">account</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mi</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">account</span><span class="p">.</span><span class="nx">N</span><span class="p">);</span>
<span class="w">    </span><span class="nx">check</span><span class="p">(</span><span class="nx">it</span><span class="p">.</span><span class="nx">isOk</span><span class="p">(),</span><span class="w"> </span><span class="s2">&quot;account not found&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">mi</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">it</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>The above code first calls the <code>let it = mi.find(account.N);</code> method to find the specified data, then calls <code>remove</code> to delete it. It calls <code>it.isOk()</code> to check whether the data at the specified index exists.</p>
<p><strong>Note:</strong></p>
<p>Here, <code>remove</code> does not need the permission of the <code>payer</code> account specified by <code>store</code> or <code>update</code> to delete data. Therefore, in actual applications, you need to call <code>asm_chain.requireAuth</code> to ensure the permission of the specified account before you can delete data, for example:</p>
<div class="highlight"><pre><span></span><code><span class="nx">requireAuth</span><span class="p">(</span><span class="nx">account</span><span class="p">);</span>
</code></pre></div>
<p>Test code:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@chain_test</span>
<span class="k">def</span> <span class="nf">test_remove</span><span class="p">(</span><span class="n">tester</span><span class="p">):</span>
    <span class="n">deploy_contract</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span> <span class="s1">&#39;counter&#39;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;account&#39;</span><span class="p">:</span> <span class="s1">&#39;hello&#39;</span><span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">push_action</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;inc&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hello&#39;</span><span class="p">:</span> <span class="s1">&#39;active&#39;</span><span class="p">})</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;++++++elapsed: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;elapsed&#39;</span><span class="p">])</span>
    <span class="n">tester</span><span class="o">.</span><span class="n">produce_block</span><span class="p">()</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">get_table_rows</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;counter&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;+++++++rows: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ret</span><span class="p">)</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">push_action</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;inc&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hello&#39;</span><span class="p">:</span> <span class="s1">&#39;active&#39;</span><span class="p">})</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;++++++elapsed: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;elapsed&#39;</span><span class="p">])</span>
    <span class="n">tester</span><span class="o">.</span><span class="n">produce_block</span><span class="p">()</span>

    <span class="n">ret</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">get_table_rows</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;counter&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;+++++++rows: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ret</span><span class="p">)</span>

    <span class="n">args</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;account&#39;</span><span class="p">:</span> <span class="s1">&#39;hello&#39;</span><span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">push_action</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;testremove&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hello&#39;</span><span class="p">:</span> <span class="s1">&#39;active&#39;</span><span class="p">})</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;++++++elapsed: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;elapsed&#39;</span><span class="p">])</span>
    <span class="n">tester</span><span class="o">.</span><span class="n">produce_block</span><span class="p">()</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">get_table_rows</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;counter&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;+++++++rows: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ret</span><span class="p">)</span>
</code></pre></div>
<p>Here, first, the <code>inc</code> action is called to ensure that there is data stored in the database, then <code>testremove</code> is called to delete the specified data, and <code>get_table_rows</code> is used to determine whether data has been added, modified, or deleted. The usage of <code>get_table_rows</code> will be introduced below.</p>
<p>Compilation:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>examples/counter
yarn
yarn<span class="w"> </span>build
</code></pre></div>
<p>Testing:</p>
<div class="highlight"><pre><span></span><code>ipyeos<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w"> </span>-s<span class="w"> </span>-x<span class="w"> </span>test.py<span class="w"> </span>-k<span class="w"> </span>test_remove
</code></pre></div>
<p>Output:</p>
<div class="highlight"><pre><span></span><code>INFO     test:test.py:93 +++++++rows: {&#39;rows&#39;: [{&#39;account&#39;: &#39;hello&#39;, &#39;count&#39;: 1}], &#39;more&#39;: False, &#39;next_key&#39;: &#39;&#39;}
INFO     test:test.py:100 +++++++rows: {&#39;rows&#39;: [{&#39;account&#39;: &#39;hello&#39;, &#39;count&#39;: 2}], &#39;more&#39;: False, &#39;next_key&#39;: &#39;&#39;}
INFO     test:test.py:107 +++++++rows: {&#39;rows&#39;: [], &#39;more&#39;: False, &#39;next_key&#39;: &#39;&#39;}
</code></pre></div>
<h2 id="lowerboundupperbound">lowerBound/upperBound</h2>
<p>These two methods are also used to find elements in the table. Unlike the <code>find</code> method, these two functions are used for fuzzy searches. The <code>lowerBound</code> method returns the <code>PrimaryIterator</code> of the first element <code>&gt;=</code> the specified <code>id</code>, and the <code>upperBound</code> method returns the <code>PrimaryIterator</code> of the first element <code>&gt;</code> the specified <code>id</code>. Let's look at the usage:</p>
<div class="highlight"><pre><span></span><code><span class="kd">@action</span><span class="p">(</span><span class="s2">&quot;testbound&quot;</span><span class="p">)</span>
<span class="nx">testBound</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Counter</span><span class="p">.</span><span class="ow">new</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">receiver</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">payer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">receiver</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Counter</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">Name</span><span class="p">(</span><span class="mf">1</span><span class="p">),</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
<span class="w">    </span><span class="nx">table</span><span class="p">.</span><span class="nx">store</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">payer</span><span class="p">);</span>

<span class="w">    </span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Counter</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">Name</span><span class="p">(</span><span class="mf">3</span><span class="p">),</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
<span class="w">    </span><span class="nx">table</span><span class="p">.</span><span class="nx">store</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">payer</span><span class="p">);</span>

<span class="w">    </span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Counter</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">Name</span><span class="p">(</span><span class="mf">5</span><span class="p">),</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
<span class="w">    </span><span class="nx">table</span><span class="p">.</span><span class="nx">store</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">payer</span><span class="p">);</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">table</span><span class="p">.</span><span class="nx">lowerBound</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
<span class="w">    </span><span class="nx">check</span><span class="p">(</span><span class="nx">it</span><span class="p">.</span><span class="nx">isOk</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">it</span><span class="p">.</span><span class="nx">primary</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bad value&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">print</span><span class="p">(</span><span class="sb">`+++++db.lower_bound(1) return primary key: </span><span class="si">${</span><span class="nx">it</span><span class="p">.</span><span class="nx">primary</span><span class="si">}</span><span class="sb">\n`</span><span class="p">);</span>

<span class="w">    </span><span class="nx">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">table</span><span class="p">.</span><span class="nx">upperBound</span><span class="p">(</span><span class="mf">3</span><span class="p">);</span>
<span class="w">    </span><span class="nx">check</span><span class="p">(</span><span class="nx">it</span><span class="p">.</span><span class="nx">isOk</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">it</span><span class="p">.</span><span class="nx">primary</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bad value&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">print</span><span class="p">(</span><span class="sb">`+++++db.lower_bound(5) return primary key: </span><span class="si">${</span><span class="nx">it</span><span class="p">.</span><span class="nx">primary</span><span class="si">}</span><span class="sb">\n`</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">Test</span><span class="w"> </span><span class="nx">code</span><span class="o">:</span>

<span class="sb">```python</span>
<span class="sb">@chain_test</span>
<span class="sb">def test_bound(tester: ChainTester):</span>
<span class="sb">    deploy_contract(tester, &#39;counter&#39;)</span>
<span class="sb">    args = {}</span>
<span class="sb">    r = tester.push_action(&#39;hello&#39;, &#39;testbound&#39;, args, {&#39;hello&#39;: &#39;active&#39;})</span>
</code></pre></div>
<p>Compilation:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>examples/counter
yarn
yarn<span class="w"> </span>build
</code></pre></div>
<p>Run the test:</p>
<div class="highlight"><pre><span></span><code>ipyeos<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w"> </span>-s<span class="w"> </span>-x<span class="w"> </span>test.py<span class="w"> </span>-k<span class="w"> </span>test_bound
</code></pre></div>
<p>Output:</p>
<div class="highlight"><pre><span></span><code>+++++db.lower_bound(1) return primary key: 1
+++++db.upper_bound(3) return primary key: 5
</code></pre></div>
<h2 id="querying-the-table-using-the-api">Querying the table using the API</h2>
<p>The above examples are all about how to operate the on-chain database tables through smart contracts. In fact, the <code>get_table_rows</code> API provided by EOS can also be used to query the on-chain tables. Both <code>ChainTester</code> in <code>ipyeos</code> and <code>ChainApiAsync</code> and <code>ChainApi</code> in <code>pyeoskit</code> provide the <code>get_table_rows</code> interface to facilitate querying operations on the table.</p>
<p>In Python code, the definition of <code>get_table_rows</code> is as follows:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_table_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_json</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">scope</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span>
                                <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">,</span>
                                <span class="n">limit</span><span class="p">,</span>
                                <span class="n">key_type</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                                <span class="n">index_position</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> 
                                <span class="n">reverse</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                <span class="n">show_payer</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Fetch smart contract data from an account. </span>
<span class="sd">    key_type: &quot;i64&quot;|&quot;i128&quot;|&quot;i256&quot;|&quot;float64&quot;|&quot;float128&quot;|&quot;sha256&quot;|&quot;ripemd160&quot;</span>
<span class="sd">    index_position: &quot;2&quot;|&quot;3&quot;|&quot;4&quot;|&quot;5&quot;|&quot;6&quot;|&quot;7&quot;|&quot;8&quot;|&quot;9&quot;|&quot;10&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<p>Explanation of the parameters of this interface:</p>
<ul>
<li><code>_json</code>: True returns data in JSON format, False returns raw data represented in hexadecimal</li>
<li><code>code</code>: the account where the table is located</li>
<li><code>scope</code>: usually set to an empty string. When there are the same <code>code</code> and <code>table</code>, different <code>scope</code> can be used to distinguish different tables</li>
<li><code>table</code>: the name of the data table to query</li>
<li><code>lower_bound</code>: query starting primary key, string type or numeric type. The string type can represent a <code>name</code> type. If it is a hexadecimal string starting with <code>0x</code>, it represents a numeric type. If it is empty, it indicates that the query starts from the beginning</li>
<li><code>upper_bound</code>: query ending primary key, string type or numeric type. The string type can represent a <code>name</code> type. If it is a hexadecimal string starting with <code>0x</code>, it represents a numeric type. If it is empty, it means that the upper limit is not set, and all values &gt;= <code>lower_bound</code> will be returned</li>
<li><code>limit</code>: used to limit the number of returned values</li>
<li><code>key_type</code>: used to specify the type of index, default is 64-bit unsigned integer type</li>
<li><code>index_position</code>: used to specify the relative position of the index. If it is empty or <code>1</code>, it means the main index, and above <code>2</code> means the position of the secondary index</li>
<li><code>reverse</code>: specifies whether to return data represented in reverse order</li>
<li><code>show_payer</code>: specifies whether to display the account that pays for RAM resources</li>
</ul>
<p>To query a table through <code>get_table_rows</code>, the structure of the table must be visible in the description of ABI. In the <code>db_example1</code> example, the generated <code>test.abi</code> contains the following information, which is a description of the table:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&quot;tables&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;counter&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Counter&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;index_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;i64&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;key_names&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">        </span><span class="nt">&quot;key_types&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</code></pre></div>
<p>Test code:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@chain_test</span>
<span class="k">def</span> <span class="nf">test_offchain_find</span><span class="p">(</span><span class="n">tester</span><span class="p">):</span>
    <span class="n">deploy_contract</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span> <span class="s1">&#39;counter&#39;</span><span class="p">)</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">push_action</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;testbound&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hello&#39;</span><span class="p">:</span> <span class="s1">&#39;active&#39;</span><span class="p">})</span>
    <span class="n">tester</span><span class="o">.</span><span class="n">produce_block</span><span class="p">()</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">get_table_rows</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;counter&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;+++++++rows: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">get_table_rows</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;counter&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;+++++++rows: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">get_table_rows</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;counter&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;+++++++rows: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</code></pre></div>
<p>Run the test code:</p>
<div class="highlight"><pre><span></span><code>ipyeos<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w"> </span>-s<span class="w"> </span>-x<span class="w"> </span>test.py<span class="w"> </span>-k<span class="w"> </span>test_offchain_find
</code></pre></div>
<p>Output:</p>
<div class="highlight"><pre><span></span><code>INFO     test:test.py:125 +++++++rows: {&#39;rows&#39;: [&#39;01000000000000000100000000000000&#39;, &#39;03000000000000000100000000000000&#39;, &#39;05000000000000000100000000000000&#39;], &#39;more&#39;: False, &#39;next_key&#39;: &#39;&#39;}
INFO     test:test.py:128 +++++++rows: {&#39;rows&#39;: [{&#39;account&#39;: &#39;............1&#39;, &#39;count&#39;: 1}, {&#39;account&#39;: &#39;............3&#39;, &#39;count&#39;: 1}, {&#39;account&#39;: &#39;............5&#39;, &#39;count&#39;: 1}], &#39;more&#39;: False, &#39;next_key&#39;: &#39;&#39;}
INFO     test:test.py:131 +++++++rows: {&#39;rows&#39;: [{&#39;account&#39;: &#39;............1&#39;, &#39;count&#39;: 1}, {&#39;account&#39;: &#39;............3&#39;, &#39;count&#39;: 1}], &#39;more&#39;: False, &#39;next_key&#39;: &#39;&#39;}
</code></pre></div>
<p>Note that here the <code>account</code> is a <code>name</code> structure and will convert the value into a string, so the output may look a bit strange.</p>
<h2 id="storage-query-and-update-of-secondary-indexes">Storage, Query, and Update of Secondary Indexes</h2>
<p>Please refer to the following example first:</p>
<p><a href="https://github.com/learnforpractice/ascdk-book/tree/master/examples/secondaryindex">Example Code</a>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Name</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Table</span><span class="p">,</span>
<span class="w">    </span><span class="nx">U128</span><span class="p">,</span>
<span class="w">    </span><span class="nx">U256</span><span class="p">,</span>
<span class="w">    </span><span class="nx">printString</span><span class="p">,</span>
<span class="w">    </span><span class="nx">printHex</span><span class="p">,</span>
<span class="w">    </span><span class="nx">check</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Contract</span><span class="p">,</span>
<span class="w">    </span><span class="nx">print</span><span class="p">,</span>
<span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;asm-chain&quot;</span><span class="p">;</span>

<span class="kd">@table</span><span class="p">(</span><span class="s2">&quot;mydata&quot;</span><span class="p">)</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">MyData</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">Table</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kr">constructor</span><span class="p">(</span>
<span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="nx">a</span><span class="o">:</span><span class="w"> </span><span class="kt">u64</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span>
<span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="nx">b</span><span class="o">:</span><span class="w"> </span><span class="kt">u64</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span>
<span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="nx">c</span><span class="o">:</span><span class="w"> </span><span class="kt">U128</span><span class="o">=</span><span class="ow">new</span><span class="w"> </span><span class="nx">U128</span><span class="p">()</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">super</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">@primary</span>
<span class="w">    </span><span class="nx">get</span><span class="w"> </span><span class="nx">getPrimary</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nx">u64</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">a</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">@secondary</span>
<span class="w">    </span><span class="nx">get</span><span class="w"> </span><span class="nx">bvalue</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nx">u64</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">b</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">@secondary</span>
<span class="w">    </span><span class="nx">set</span><span class="w"> </span><span class="nx">bvalue</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">u64</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">value</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">@secondary</span>
<span class="w">    </span><span class="nx">get</span><span class="w"> </span><span class="nx">cvalue</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nx">U128</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">c</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">@secondary</span>
<span class="w">    </span><span class="nx">set</span><span class="w"> </span><span class="nx">cvalue</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">U128</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">value</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">@contract</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">MyContract</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">Contract</span><span class="p">{</span>
<span class="w">    </span><span class="kd">@action</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">testSecondary</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">mi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">MyData</span><span class="p">.</span><span class="ow">new</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">receiver</span><span class="p">);</span>

<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MyData</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">U128</span><span class="p">(</span><span class="mf">3</span><span class="p">));</span>
<span class="w">        </span><span class="nx">mi</span><span class="p">.</span><span class="nx">store</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">receiver</span><span class="p">);</span>

<span class="w">        </span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MyData</span><span class="p">(</span><span class="mf">11</span><span class="p">,</span><span class="w"> </span><span class="mf">22</span><span class="p">,</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">U128</span><span class="p">(</span><span class="mf">33</span><span class="p">));</span>
<span class="w">        </span><span class="nx">mi</span><span class="p">.</span><span class="nx">store</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">receiver</span><span class="p">);</span>

<span class="w">        </span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MyData</span><span class="p">(</span><span class="mf">111</span><span class="p">,</span><span class="w"> </span><span class="mf">222</span><span class="p">,</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">U128</span><span class="p">(</span><span class="mf">333</span><span class="p">));</span>
<span class="w">        </span><span class="nx">mi</span><span class="p">.</span><span class="nx">store</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">receiver</span><span class="p">);</span>


<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mi</span><span class="p">.</span><span class="nx">bvalueDB</span><span class="p">;</span><span class="w">    </span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">idxIt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">idx</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="mf">2</span><span class="p">);</span>
<span class="w">        </span><span class="nx">printString</span><span class="p">(</span><span class="sb">`+++++++++idx64.find: </span><span class="si">${</span><span class="nx">idxIt</span><span class="p">.</span><span class="nx">i</span><span class="si">}</span><span class="sb">, </span><span class="si">${</span><span class="nx">idxIt</span><span class="p">.</span><span class="nx">primary</span><span class="si">}</span><span class="sb">\n`</span><span class="p">);</span>
<span class="w">        </span><span class="nx">check</span><span class="p">(</span><span class="nx">idxIt</span><span class="p">.</span><span class="nx">primary</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bad value&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">idx</span><span class="p">.</span><span class="nx">lowerBound</span><span class="p">(</span><span class="mf">2</span><span class="p">);</span>
<span class="w">        </span><span class="nx">check</span><span class="p">(</span><span class="nx">ret</span><span class="p">.</span><span class="nx">primary</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bad value&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="nx">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">idx</span><span class="p">.</span><span class="nx">upperBound</span><span class="p">(</span><span class="mf">22</span><span class="p">);</span>
<span class="w">        </span><span class="nx">check</span><span class="p">(</span><span class="nx">ret</span><span class="p">.</span><span class="nx">primary</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">111</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bad value&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">@action</span><span class="p">(</span><span class="s2">&quot;testupdate&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">testSecondaryUpdate</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">mi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">MyData</span><span class="p">.</span><span class="ow">new</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">receiver</span><span class="p">);</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mi</span><span class="p">.</span><span class="nx">bvalueDB</span><span class="p">;</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">idxIt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">idx</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="mf">222</span><span class="p">);</span>
<span class="w">        </span><span class="nx">check</span><span class="p">(</span><span class="nx">idxIt</span><span class="p">.</span><span class="nx">isOk</span><span class="p">(),</span><span class="w"> </span><span class="s2">&quot;value 222 not found&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">check</span><span class="p">(</span><span class="nx">idxIt</span><span class="p">.</span><span class="nx">primary</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">111</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bad primary value&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">mi</span><span class="p">.</span><span class="nx">updateBvalue</span><span class="p">(</span><span class="nx">idxIt</span><span class="p">,</span><span class="w"> </span><span class="mf">223</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">receiver</span><span class="p">);</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">idx</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="mf">22</span><span class="p">);</span>
<span class="w">        </span><span class="nx">check</span><span class="p">(</span><span class="nx">ret</span><span class="p">.</span><span class="nx">isOk</span><span class="p">(),</span><span class="w"> </span><span class="s2">&quot;bad scondary value&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">@action</span><span class="p">(</span><span class="s2">&quot;testremove&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">testSecondaryRemove</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">MyData</span><span class="p">.</span><span class="ow">new</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">receiver</span><span class="p">);</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">table</span><span class="p">.</span><span class="nx">bvalueDB</span><span class="p">;</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">idxIt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">idx</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="mf">222</span><span class="p">);</span>
<span class="w">        </span><span class="nx">check</span><span class="p">(</span><span class="nx">idxIt</span><span class="p">.</span><span class="nx">isOk</span><span class="p">(),</span><span class="w"> </span><span class="s2">&quot;value 222 not found&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">check</span><span class="p">(</span><span class="nx">idxIt</span><span class="p">.</span><span class="nx">primary</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">111</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bad primary value&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">primaryIt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">table</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">idxIt</span><span class="p">.</span><span class="nx">primary</span><span class="p">);</span>
<span class="w">        </span><span class="nx">check</span><span class="p">(</span><span class="nx">primaryIt</span><span class="p">.</span><span class="nx">isOk</span><span class="p">(),</span><span class="w"> </span><span class="s2">&quot;bad primary value&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">table</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">primaryIt</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>
</code></pre></div></p>
<p>In this example, two secondary indexes are defined:</p>
<div class="highlight"><pre><span></span><code><span class="kd">@secondary</span>
<span class="nx">get</span><span class="w"> </span><span class="nx">bvalue</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nx">u64</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">b</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">@secondary</span>
<span class="nx">set</span><span class="w"> </span><span class="nx">bvalue</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">u64</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">value</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">@secondary</span>
<span class="nx">get</span><span class="w"> </span><span class="nx">cvalue</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nx">U128</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">c</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">@secondary</span>
<span class="nx">set</span><span class="w"> </span><span class="nx">cvalue</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">U128</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">value</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>The <code>test</code> action calls the <code>store</code> method to store three sets of data and demonstrates how to use <code>lowerBound</code> to find the secondary index.</li>
<li>The <code>testupdate</code> action demonstrates how to call the generated <code>updateBvalue</code> method to update data of the secondary index. <code>updateBvalue</code> is a generated method, the pattern is <code>update</code> + method name of the secondary index.</li>
</ul>
<p>Test code:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@chain_test</span>
<span class="k">def</span> <span class="nf">test_secondary_update</span><span class="p">(</span><span class="n">tester</span><span class="p">:</span> <span class="n">ChainTester</span><span class="p">):</span>
    <span class="n">deploy_contract</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span> <span class="s1">&#39;secondaryindex&#39;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">push_action</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hello&#39;</span><span class="p">:</span> <span class="s1">&#39;active&#39;</span><span class="p">})</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;++++++elapsed: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;elapsed&#39;</span><span class="p">])</span>
    <span class="n">tester</span><span class="o">.</span><span class="n">produce_block</span><span class="p">()</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">push_action</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;testupdate&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hello&#39;</span><span class="p">:</span> <span class="s1">&#39;active&#39;</span><span class="p">})</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;++++++elapsed: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;elapsed&#39;</span><span class="p">])</span>
    <span class="n">tester</span><span class="o">.</span><span class="n">produce_block</span><span class="p">()</span>
</code></pre></div>
<p>Compile:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>examples/secondaryindex
yarn
yarn<span class="w"> </span>build
</code></pre></div>
<p>Run the test:</p>
<div class="highlight"><pre><span></span><code>ipyeos<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w"> </span>-s<span class="w"> </span>-x<span class="w"> </span>test.py<span class="w"> </span>-k<span class="w"> </span>test_secondary_update
</code></pre></div>
<p>Output:
<div class="highlight"><pre><span></span><code>INFO     test:test.py:85 {&#39;rows&#39;: [{&#39;a&#39;: 1, &#39;b&#39;: 2, &#39;c&#39;: &#39;3&#39;}, {&#39;a&#39;: 11, &#39;b&#39;: 22, &#39;c&#39;: &#39;33&#39;}, {&#39;a&#39;: 111, &#39;b&#39;: 222, &#39;c&#39;: &#39;333&#39;}], &#39;more&#39;: False, &#39;next_key&#39;: &#39;&#39;}
INFO     test:test.py:92 {&#39;rows&#39;: [{&#39;a&#39;: 1, &#39;b&#39;: 2, &#39;c&#39;: &#39;3&#39;}, {&#39;a&#39;: 11, &#39;b&#39;: 22, &#39;c&#39;: &#39;33&#39;}, {&#39;a&#39;: 111, &#39;b&#39;: 223, &#39;c&#39;: &#39;333&#39;}], &#39;more&#39;: False, &#39;next_key&#39;: &#39;&#39;}
</code></pre></div></p>
<p>From the output of:</p>
<div class="highlight"><pre><span></span><code>{&#39;a&#39;: 111, &#39;b&#39;: 223, &#39;c&#39;: &#39;333&#39;}
</code></pre></div>
<p>We can see that 222 has been changed to 223, and other values remain the same.</p>
<h2 id="deletion-of-secondary-indexes">Deletion of Secondary Indexes</h2>
<div class="highlight"><pre><span></span><code><span class="kd">@action</span><span class="p">(</span><span class="s2">&quot;testremove&quot;</span><span class="p">)</span>
<span class="nx">testSecondaryRemove</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">MyData</span><span class="p">.</span><span class="ow">new</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">receiver</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">table</span><span class="p">.</span><span class="nx">bvalueDB</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">idxIt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">idx</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="mf">222</span><span class="p">);</span>
<span class="w">    </span><span class="nx">check</span><span class="p">(</span><span class="nx">idxIt</span><span class="p">.</span><span class="nx">isOk</span><span class="p">(),</span><span class="w"> </span><span class="s2">&quot;value 222 not found&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">check</span><span class="p">(</span><span class="nx">idxIt</span><span class="p">.</span><span class="nx">primary</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">111</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bad primary value&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">primaryIt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">table</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">idxIt</span><span class="p">.</span><span class="nx">primary</span><span class="p">);</span>
<span class="w">    </span><span class="nx">check</span><span class="p">(</span><span class="nx">primaryIt</span><span class="p">.</span><span class="nx">isOk</span><span class="p">(),</span><span class="w"> </span><span class="s2">&quot;bad primary value&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">table</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">primaryIt</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Explanation of the above code:</p>
<ul>
<li><code>let idxIt = idx.find(222);</code> Search for secondary index.</li>
<li><code>let primaryIt = table.find(idxIt.primary);</code> Get the primary index through <code>idxIt.primary</code>, and then return the <code>PrimaryIterator</code> of the primary index.</li>
<li><code>table.remove(primaryIt)</code> Deletes the element in the table, including the primary index and all secondary indexes.</li>
</ul>
<p>From the above example, we can see that the deletion of a secondary index first involves finding the primary index through the secondary index and then deleting all data including the secondary index through the primary index.</p>
<p>Test code:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@chain_test</span>
<span class="k">def</span> <span class="nf">test_secondary_remove</span><span class="p">(</span><span class="n">tester</span><span class="p">:</span> <span class="n">ChainTester</span><span class="p">):</span>
    <span class="n">deploy_contract</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span> <span class="s1">&#39;secondaryindex&#39;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">push_action</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hello&#39;</span><span class="p">:</span> <span class="s1">&#39;active&#39;</span><span class="p">})</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;++++++elapsed: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;elapsed&#39;</span><span class="p">])</span>
    <span class="n">tester</span><span class="o">.</span><span class="n">produce_block</span><span class="p">()</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">get_table_rows</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;mydata&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">push_action</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;testremove&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hello&#39;</span><span class="p">:</span> <span class="s1">&#39;active&#39;</span><span class="p">})</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;++++++elapsed: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;elapsed&#39;</span><span class="p">])</span>
    <span class="n">tester</span><span class="o">.</span><span class="n">produce_block</span><span class="p">()</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">get_table_rows</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;mydata&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
</code></pre></div>
<p>Compile:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>examples/secondaryindex
yarn
yarn<span class="w"> </span>build
</code></pre></div>
<p>Run the test:</p>
<div class="highlight"><pre><span></span><code>ipyeos<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w"> </span>-s<span class="w"> </span>-x<span class="w"> </span>test.py<span class="w"> </span>-k<span class="w"> </span>test_secondary_remove
</code></pre></div>
<p>Output:</p>
<div class="highlight"><pre><span></span><code>INFO     test:test.py:102 {&#39;rows&#39;: [{&#39;a&#39;: 1, &#39;b&#39;: 2, &#39;c&#39;: &#39;3&#39;}, {&#39;a&#39;: 11, &#39;b&#39;: 22, &#39;c&#39;: &#39;33&#39;}, {&#39;a&#39;: 111, &#39;b&#39;: 222, &#39;c&#39;: &#39;333&#39;}], &#39;more&#39;: False, &#39;next_key&#39;: &#39;&#39;}
INFO     test:test.py:108 {&#39;rows&#39;: [{&#39;a&#39;: 1, &#39;b&#39;: 2, &#39;c&#39;: &#39;3&#39;}, {&#39;a&#39;: 11, &#39;b&#39;: 22, &#39;c&#39;: &#39;33&#39;}], &#39;more&#39;: False, &#39;next_key&#39;: &#39;&#39;}
</code></pre></div>
<p>Comparing the return values of the two get_table_rows calls, you will find that the data set <code>{'a': 111, 'b': 222, 'c': '333'}</code> has been deleted.</p>
<h2 id="using-api-for-secondary-index-query-on-tables">Using API for Secondary Index Query on Tables</h2>
<p>The above example defined two secondary indexes, the types of which are <code>u64</code> and <code>u128</code> respectively. The <code>get_table_rows</code> API also supports finding corresponding values through secondary indexes.</p>
<div class="highlight"><pre><span></span><code><span class="nd">@chain_test</span>
<span class="k">def</span> <span class="nf">test_offchain_find</span><span class="p">(</span><span class="n">tester</span><span class="p">:</span> <span class="n">ChainTester</span><span class="p">):</span>
    <span class="n">deploy_contract</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span> <span class="s1">&#39;secondaryindex&#39;</span><span class="p">)</span>

    <span class="n">args</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">push_action</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;test1&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hello&#39;</span><span class="p">:</span> <span class="s1">&#39;active&#39;</span><span class="p">})</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">get_table_rows</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;mydata&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">key_type</span><span class="o">=</span><span class="s2">&quot;i64&quot;</span><span class="p">,</span> <span class="n">index_position</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;+++++++rows: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">get_table_rows</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;mydata&#39;</span><span class="p">,</span> <span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">key_type</span><span class="o">=</span><span class="s2">&quot;i64&quot;</span><span class="p">,</span> <span class="n">index_position</span><span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;+++++++rows: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
    <span class="c1"># 0x14d == 333</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">get_table_rows</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;mydata&#39;</span><span class="p">,</span> <span class="s1">&#39;0x14d&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">key_type</span><span class="o">=</span><span class="s2">&quot;i128&quot;</span><span class="p">,</span> <span class="n">index_position</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;+++++++rows: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</code></pre></div>
<p><strong>Note</strong> that when querying <code>c</code>, since the type is <code>u128</code>, for values beyond the range of <code>u64</code> type, hexadecimal can be used to represent data, such as <code>0x14d</code> in the above code, which is <code>333</code> in decimal.</p>
<p>Run the test case:</p>
<div class="highlight"><pre><span></span><code>ipyeos<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w"> </span>-s<span class="w"> </span>-x<span class="w"> </span>test.py<span class="w"> </span>-k<span class="w"> </span>test_offchain_find
</code></pre></div>
<p>The running result of the above test code is as follows:</p>
<div class="highlight"><pre><span></span><code>INFO     test:test.py:117 +++++++rows: {&#39;rows&#39;: [{&#39;a&#39;: 1, &#39;b&#39;: 2, &#39;c&#39;: &#39;3&#39;}, {&#39;a&#39;: 11, &#39;b&#39;: 22, &#39;c&#39;: &#39;33&#39;}, {&#39;a&#39;: 111, &#39;b&#39;: 222, &#39;c&#39;: &#39;333&#39;}], &#39;more&#39;: False, &#39;next_key&#39;: &#39;&#39;}
INFO     test:test.py:120 +++++++rows: {&#39;rows&#39;: [{&#39;a&#39;: 11, &#39;b&#39;: 22, &#39;c&#39;: &#39;33&#39;}, {&#39;a&#39;: 111, &#39;b&#39;: 222, &#39;c&#39;: &#39;333&#39;}], &#39;more&#39;: False, &#39;next_key&#39;: &#39;&#39;}
INFO     test:test.py:123 +++++++rows: {&#39;rows&#39;: [{&#39;a&#39;: 111, &#39;b&#39;: 222, &#39;c&#39;: &#39;333&#39;}], &#39;more&#39;: False, &#39;next_key&#39;: &#39;&#39;}
</code></pre></div>
<h2 id="summary">Summary</h2>
<p>The data storage function in EOS is quite comprehensive, and the feature of secondary index tables makes data lookup very flexible. This chapter has detailed the addition, deletion, modification, and query of database tables. There is a lot of content in this chapter, so it will take some time to digest. You can try to make some modifications based on the example and try running it to increase your understanding of the knowledge points in this chapter.</p>
<p><a href="https://github.com/learnforpractice/ascdk-book/tree/master/examples/counter">Example code 1</a>
<a href="https://github.com/learnforpractice/ascdk-book/tree/master/examples/secondaryindex">Example code 2</a></p>





  <h2 id="__comments">Comments</h2>
  <!-- Insert generated snippet here -->
  <script src="https://giscus.app/client.js"
        data-repo="learnforpractice/ascdk-book"
        data-repo-id="R_kgDOJobMJw"
        data-category="Q&A"
        data-category-id="DIC_kwDOJobMJ84CW2ZH"
        data-mapping="title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
  </script>

  <!-- Synchronize Giscus theme with palette -->
  <script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate" ? "dark" : "light"
      giscus.setAttribute("data-theme", theme) 
    }

    /* Register event handlers after documented loaded */
    // document.addEventListener("DOMContentLoaded", function() {
    //   var ref = document.querySelector("[data-md-component=palette]")
    //   ref.addEventListener("change", function() {
    //     var palette = __md_get("__palette")
    //     if (palette && typeof palette.color === "object") {
    //       var theme = palette.color.scheme === "slate" ? "dark" : "light"

    //       /* Instruct Giscus to change theme */
    //       var frame = document.querySelector(".giscus-frame")
    //       frame.contentWindow.postMessage(
    //         { giscus: { setConfig: { theme } } },
    //         "https://giscus.app"
    //       )
    //     }
    //   })
    // })
  </script>

                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.19047be9.min.js"></script>
      
    
  </body>
</html>